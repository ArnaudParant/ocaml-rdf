<!DOCTYPE HTML>
<html>
<head>
<title>OCaml-RDF : Using graphs</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="http://zoggy.github.io/ocaml-rdf/style.css" rel="stylesheet" type="text/css"/>
<rssfeed></rssfeed>
</head><body>
<div id="page">
<div class="navbar navbar-fixed-top">
<div class="navbar-inner">
<div class="container">

  <div class="nav-collapse">
  <ul class="nav">
    <li class="&lt;navbar-home/&gt;"><a href="http://zoggy.github.io/ocaml-rdf">OCaml-RDF</a></li>
    <li class="&lt;navbar-download/&gt;"><a href="http://zoggy.github.io/ocaml-rdf/download.html">Download</a></li>
    <li class="active"><a href="http://zoggy.github.io/ocaml-rdf/doc.html">Documentation</a></li>
    <li class="&lt;navbar-blog/&gt;"><a href="http://zoggy.github.io/ocaml-rdf/blog.html">Blog</a></li>
    <li class="&lt;navbar-about/&gt;"><a href="http://zoggy.github.io/ocaml-rdf/about.html">?</a></li>
  </ul>
  </div>
  <div class="nav pull-right">

  </div>
</div>
</div>
</div>

<div id="header">

<div class="page-title">Using graphs</div>
</div>
<span></span>



<ul class="toc"><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#creategraph">Creating a graph</a></li><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#querying">Querying the graph</a></li><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#import">Importing and exporting</a></li><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#transactions">Transactions</a></li><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#dot">Dot output</a></li><li class="toc-section"><a href="http://zoggy.github.io/ocaml-rdf/doc-graphs.html#namespaces">Namespaces</a></li></ul>
<div class="section"><div class="section-title" id="creategraph">Creating a graph</div>
<p id="AnRDFgraphneedsabaseIRIw"><a class="paragraph-url" href="#AnRDFgraphneedsabaseIRIw"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
An RDF graph needs a base IRI, which can be used to name the graph.
Such a IRI is created using the 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_iri.html">Rdf_iri</a>
 module.
Then we use the 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_graph.html#VALopen_graph">Rdf_graph.open_graph</a>

function to create an empty graph:
</p>
<pre class="code-ocaml" id="letbase_iriRdf_iriirihtt"><a class="paragraph-url" href="#letbase_iriRdf_iriirihtt"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div><span class="hl kwa">let</span> base_iri <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://foo.bar.net&quot;</span><span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> g <span class="hl opt">=</span> <span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>open_graph base_iri <span class="hl opt">;;</span></div></pre>
<p id="Ifnooptionisprovidedtheg"><a class="paragraph-url" href="#Ifnooptionisprovidedtheg"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
If no option is provided, the graph is created in memory.
You can <a href="http://zoggy.github.io/ocaml-rdf/doc-databases.html">create graphs stored in a MySQL or Postgresql
datatabase</a>.
</p>
<p id="Oncethegraphiscreatedlet"><a class="paragraph-url" href="#Oncethegraphiscreatedlet"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Once the graph is created, let's insert triples in the graph,
to associate the name &quot;Alice&quot; and the mailbox address IRI
&quot;mailto:alice@mbox.net&quot; to a new blank term:
</p>
<pre class="code-ocaml" id="letfoaf_nameRdf_iriiriht"><a class="paragraph-url" href="#letfoaf_nameRdf_iriiriht"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div># <span class="hl kwa">let</span> foaf_name <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://xmlns.com/foaf/0.1/name&quot;</span><span class="hl opt">;;</span></div><div class="ocaml-toplevel">val foaf_name : Rdf_iri.iri = &lt;abstr&gt;</div><div># <span class="hl kwa">let</span> foaf_mbox <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://xmlns.com/foaf/0.1/mbox&quot;</span><span class="hl opt">;;</span></div><div class="ocaml-toplevel">val foaf_mbox : Rdf_iri.iri = &lt;abstr&gt;</div><div># <span class="hl kwa">let</span> a <span class="hl opt">=</span> <span class="hl kwc">Rdf_term</span><span class="hl opt">.</span><span class="hl kwd">Blank_</span> <span class="hl opt">(</span>g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>new_blank_id<span class="hl opt">());;</span></div><div class="ocaml-toplevel">val a : Rdf_term.term = Rdf_term.Blank_ &lt;abstr&gt;</div><div># g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>add_triple
   ~sub<span class="hl opt">:</span> a ~pred<span class="hl opt">:</span> foaf_name
   ~obj<span class="hl opt">: (</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span>term_of_literal_string <span class="hl str">&quot;Alice&quot;</span><span class="hl opt">);;</span></div><div class="ocaml-toplevel">- : unit = ()</div><div># g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>add_triple
   ~sub<span class="hl opt">:</span> a ~pred<span class="hl opt">:</span> foaf_mbox
   ~obj<span class="hl opt">: (</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span><span class="hl kwd">Iri</span> <span class="hl opt">(</span><span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;mailto:alice@mbox.net&quot;</span><span class="hl opt">));;</span></div><div class="ocaml-toplevel">- : unit = ()</div><div># <span class="hl kwa">let</span> b <span class="hl opt">=</span> <span class="hl kwc">Rdf_term</span><span class="hl opt">.</span><span class="hl kwd">Blank_</span> <span class="hl opt">(</span>g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>new_blank_id<span class="hl opt">());;</span></div><div class="ocaml-toplevel">val b : Rdf_term.term = Rdf_term.Blank_ &lt;abstr&gt;</div><div># g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>add_triple
   ~sub<span class="hl opt">:</span> b ~pred<span class="hl opt">:</span> foaf_name
   ~obj<span class="hl opt">: (</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span>term_of_literal_string <span class="hl str">&quot;Bob&quot;</span><span class="hl opt">);;</span></div><div class="ocaml-toplevel">- : unit = ()</div><div># g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>add_triple
   ~sub<span class="hl opt">:</span> b ~pred<span class="hl opt">:</span> foaf_mbox
   ~obj<span class="hl opt">: (</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span><span class="hl kwd">Iri</span> <span class="hl opt">(</span><span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;mailto:bob@mbox.net&quot;</span><span class="hl opt">));;</span></div><div class="ocaml-toplevel">- : unit = ()</div></pre>
<p id="Hereisthecontentofourgra"><a class="paragraph-url" href="#Hereisthecontentofourgra"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Here is the content of our graph, in Turtle format:</p>

<pre class="code-ocaml" id="prefixrdfhttpwwww3org199"><a class="paragraph-url" href="#prefixrdfhttpwwww3org199"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div class="ocaml-toplevel"></div><div class="ocaml-toplevel">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
_:genid1-364597014 &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Bob&quot; .
_:genid1-364597014 &lt;http://xmlns.com/foaf/0.1/mbox&gt; &lt;mailto:bob@mbox.net&gt; .
_:genid0-721174886 &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Alice&quot; .
_:genid0-721174886 &lt;http://xmlns.com/foaf/0.1/mbox&gt; &lt;mailto:alice@mbox.net&gt; .
</div></pre>

</div>
<div class="section"><div class="section-title" id="querying">Querying the graph</div>
<p id="LetsusesomeoftheRdf_grap"><a class="paragraph-url" href="#LetsusesomeoftheRdf_grap"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Let's use some of the 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_graph.html#TYPEgraph">Rdf_graph.graph</a>
 structure fields to
retrieve information from the graph.
</p>
<p id="Herewelookforthemailboxe"><a class="paragraph-url" href="#Herewelookforthemailboxe"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Here we look for the mailboxes of Alice, by querying the objects of
triples having a specified subject and object:
</p>
<pre class="code-ocaml" id="letalice_mboxgRdf_grapho"><a class="paragraph-url" href="#letalice_mboxgRdf_grapho"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div># <span class="hl kwa">let</span> alice_mbox <span class="hl opt">=</span> g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>objects_of
  ~sub<span class="hl opt">:</span> a ~pred<span class="hl opt">:</span> foaf_mbox<span class="hl opt">;;</span></div><div class="ocaml-toplevel">val alice_mbox : Rdf_term.term list = [Rdf_term.Iri &lt;abstr&gt;]</div><div># <span class="hl kwc">List</span><span class="hl opt">.</span>iter <span class="hl opt">(</span><span class="hl kwa">fun</span> n <span class="hl opt">-&gt;</span> print_endline <span class="hl opt">(</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span>string_of_term n<span class="hl opt">))</span> alice_mbox<span class="hl opt">;;</span></div><div class="ocaml-toplevel">&lt;mailto:alice@mbox.net&gt;
- : unit = ()</div></pre>
<p id="Letsnowqueryalltriplesha"><a class="paragraph-url" href="#Letsnowqueryalltriplesha"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Let's now query all triples having the predicate <code>foaf_name</code>,
and use the 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_ttl.html#VALstring_of_triple">Rdf_ttl.string_of_triple</a>
 function
to display the result:
</p>
<pre class="code-ocaml" id="lettriplesgRdf_graphfind"><a class="paragraph-url" href="#lettriplesgRdf_graphfind"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div># <span class="hl kwa">let</span> triples <span class="hl opt">=</span> g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>find ~pred<span class="hl opt">:</span> foaf_name <span class="hl opt">();;</span></div><div class="ocaml-toplevel">val triples : Rdf_term.triple list =
  [(Rdf_term.Blank_ &lt;abstr&gt;, &lt;abstr&gt;,
    Rdf_term.Literal
     {Rdf_term.lit_value = &quot;Alice&quot;; lit_language = None; lit_type = None});
   (Rdf_term.Blank_ &lt;abstr&gt;, &lt;abstr&gt;,
    Rdf_term.Literal
     {Rdf_term.lit_value = &quot;Bob&quot;; lit_language = None; lit_type = ...});
   ...]</div><div># <span class="hl kwc">List</span><span class="hl opt">.</span>iter
   <span class="hl opt">(</span><span class="hl kwa">fun</span> <span class="hl opt">(</span>sub<span class="hl opt">,</span>pred<span class="hl opt">,</span>obj<span class="hl opt">) -&gt;</span>
     print_endline <span class="hl opt">(</span><span class="hl kwc">Rdf_ttl</span><span class="hl opt">.</span>string_of_triple ~sub ~pred ~obj<span class="hl opt">))</span>
   triples<span class="hl opt">;;</span></div><div class="ocaml-toplevel">_:genid0-721174886 &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Alice&quot; .
_:genid1-364597014 &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Bob&quot; .
- : unit = ()</div></pre>
<p id="Thesearesimplewaystoquer"><a class="paragraph-url" href="#Thesearesimplewaystoquer"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>These are simple ways to query the graph.
<a href="http://zoggy.github.io/ocaml-rdf/doc-sparql.html">Sparql queries can be used</a> to execute
more powerful and more complex queries.
</p>
</div>

<div class="section"><div class="section-title" id="import">Importing and exporting</div>
<p id="TheRDFXMLandTurtleformat"><a class="paragraph-url" href="#TheRDFXMLandTurtleformat"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
The <span class="ext-a"><a href="http://www.w3.org/TR/rdf-syntax-grammar">RDF/XML</a></span> and
<span class="ext-a"><a href="http://www.w3.org/TeamSubmission/turtle/">Turtle</a></span> formats
are supported to import and export triples.
The corresponding functions are provided in modules

<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_xml.html">Rdf_xml</a>
 and 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_ttl.html">Rdf_ttl</a>
.
</p>
<p id="Hereisanexampleofcodecre"><a class="paragraph-url" href="#Hereisanexampleofcodecre"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Here is an example of code creating a graph, importing from a
RDF/XML file <code>example.rdf</code> and exporting to a Turtle file
<code>example.ttl</code>:
</p>
<pre class="code-ocaml" id="letbaseRdf_iriirihttphel"><a class="paragraph-url" href="#letbaseRdf_iriirihttphel"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div># <span class="hl kwa">let</span> base <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://hello.fr&quot;</span> <span class="hl opt">;;</span></div><div class="ocaml-toplevel">val base : Rdf_iri.iri = &lt;abstr&gt;</div><div># <span class="hl kwa">let</span> g <span class="hl opt">=</span> <span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>open_graph base <span class="hl opt">;;</span></div><div class="ocaml-toplevel">val g : Rdf_graph.graph =
  {Rdf_graph.name = &lt;fun&gt;; size = &lt;fun&gt;; add_triple = &lt;fun&gt;;
   rem_triple = &lt;fun&gt;; add_triple_t = &lt;fun&gt;; rem_triple_t = &lt;fun&gt;;
   subjects_of = &lt;fun&gt;; predicates_of = &lt;fun&gt;; objects_of = &lt;fun&gt;;
   find = &lt;fun&gt;; exists = &lt;fun&gt;; exists_t = &lt;fun&gt;; subjects = &lt;fun&gt;;
   predicates = &lt;fun&gt;; objects = &lt;fun&gt;; transaction_start = &lt;fun&gt;;
   transaction_commit = &lt;fun&gt;; transaction_rollback = &lt;fun&gt;;
   new_blank_id = &lt;fun&gt;; namespaces = ...; add_namespace = ...;
   rem_namespace = ...; set_namespaces = ...; bgp = ...}</div><div># <span class="hl kwc">Rdf_xml</span><span class="hl opt">.</span>from_file g <span class="hl str">&quot;example.rdf&quot;</span><span class="hl opt">;;</span></div><div class="ocaml-toplevel">- : unit = ()</div><div># <span class="hl kwc">Rdf_ttl</span><span class="hl opt">.</span>to_file g <span class="hl str">&quot;example.ttl&quot;</span><span class="hl opt">;;</span></div><div class="ocaml-toplevel">- : unit = ()</div></pre>
</div>

<div class="section"><div class="section-title" id="transactions">Transactions</div>
<p id="Transactionscanbeusedift"><a class="paragraph-url" href="#Transactionscanbeusedift"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Transactions can be used if the backend support them.
The storage in memory supports nested transactions, and database
backends support one level of transaction.
</p>
<p id="Transactionsarehandledwi"><a class="paragraph-url" href="#Transactionsarehandledwi"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Transactions are handled with the
<code>transaction_start</code>, <code>transaction_commit</code>
and <code>transaction_rollback</code> of the the

<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_graph.html#TYPEgraph">Rdf_graph.graph</a>
 structure.
</p>
<p id="Asanexampleletsloaddataf"><a class="paragraph-url" href="#Asanexampleletsloaddataf"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>As an example, let's load data from a file:</p>
<pre class="code-ocaml"><div><span class="hl kwa">let</span> base <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://hello.fr&quot;</span> <span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> g <span class="hl opt">=</span> <span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>open_graph base <span class="hl opt">;;</span></div><div><span class="hl kwc">Rdf_ttl</span><span class="hl opt">.</span>from_file g <span class="hl str">&quot;example.ttl&quot;</span><span class="hl opt">;;</span></div></pre>
<p id="Thisisourloadeddata"><a class="paragraph-url" href="#Thisisourloadeddata"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>This is our loaded data:</p>

<pre class="code-ocaml"><div class="ocaml-toplevel"></div><div class="ocaml-toplevel">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix dc: &lt;http://purl.org/dc/elements/1.1/&gt; .
@prefix ex: &lt;http://example.org/stuff/1.0/&gt; .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; rdf:editor _:genid0-131393091 .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; dc:title &quot;RDF/XML Syntax Specification (Revised)&quot; .
_:genid0-131393091 ex:homePage &lt;http://purl.org/net/dajobe/&gt; .
_:genid0-131393091 ex:fullName &quot;Dave Beckett&quot; .
</div></pre>

<p id="Nowletsstartatransaction"><a class="paragraph-url" href="#Nowletsstartatransaction"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Now let's start a transaction, and modify the graph:</p>
<pre class="code-ocaml" id="gRdf_graphtransaction_st"><a class="paragraph-url" href="#gRdf_graphtransaction_st"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div>g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>transaction_start<span class="hl opt">();;</span></div><div><span class="hl kwa">let</span> pred <span class="hl opt">=</span> <span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span>iri <span class="hl str">&quot;http://example.org/stuff/1.0/fullName&quot;</span> <span class="hl opt">;;</span></div><div><span class="hl kwa">match</span> g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>find ~pred <span class="hl opt">()</span> <span class="hl kwa">with</span>
| <span class="hl opt">(</span>sub<span class="hl opt">,</span>_<span class="hl opt">,</span>obj<span class="hl opt">) ::</span> _ <span class="hl opt">-&gt;</span>
  <span class="hl com">(* remove a triple *)</span>
  g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>rem_triple ~sub ~pred ~obj<span class="hl opt">;</span>
  <span class="hl com">(* add a new triple, with a different name *)</span>
  g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>add_triple ~sub ~pred
    ~obj<span class="hl opt">: (</span><span class="hl kwc">Rdf_term</span><span class="hl opt">.</span>term_of_literal_string <span class="hl str">&quot;Jean Dupont&quot;</span><span class="hl opt">)</span>
| _ <span class="hl opt">-&gt;</span> <span class="hl kwa">assert false</span><span class="hl opt">;;</span></div></pre>
<p id="Nowthegraphlookslike"><a class="paragraph-url" href="#Nowthegraphlookslike"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>Now the graph looks like:</p>

<pre class="code-ocaml"><div class="ocaml-toplevel"></div><div class="ocaml-toplevel">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix dc: &lt;http://purl.org/dc/elements/1.1/&gt; .
@prefix ex: &lt;http://example.org/stuff/1.0/&gt; .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; rdf:editor _:genid0-131393091 .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; dc:title &quot;RDF/XML Syntax Specification (Revised)&quot; .
_:genid0-131393091 ex:homePage &lt;http://purl.org/net/dajobe/&gt; .
_:genid0-131393091 ex:fullName &quot;Jean Dupont&quot; .
</div></pre>

<p id="Ifwerollbackwegettheprev"><a class="paragraph-url" href="#Ifwerollbackwegettheprev"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>If we rollback, we get the previous graph:</p>
<pre class="code-ocaml" id="gRdf_graphtransaction_ro"><a class="paragraph-url" href="#gRdf_graphtransaction_ro"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div>g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>transaction_rollback<span class="hl opt">();;</span></div></pre>

<pre class="code-ocaml"><div class="ocaml-toplevel"></div><div class="ocaml-toplevel">@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix dc: &lt;http://purl.org/dc/elements/1.1/&gt; .
@prefix ex: &lt;http://example.org/stuff/1.0/&gt; .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; rdf:editor _:genid0-131393091 .
&lt;http://www.w3.org/TR/rdf-syntax-grammar&gt; dc:title &quot;RDF/XML Syntax Specification (Revised)&quot; .
_:genid0-131393091 ex:homePage &lt;http://purl.org/net/dajobe/&gt; .
_:genid0-131393091 ex:fullName &quot;Dave Beckett&quot; .
</div></pre>

</div>

<div class="section"><div class="section-title" id="dot">Dot output</div>
<p id="RDFgraphscanbedumpedinGr"><a class="paragraph-url" href="#RDFgraphscanbedumpedinGr"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
RDF graphs can be dumped in Graphviz (dot) format, with the

<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_dot.html">Rdf_dot</a>
 module. The following code
generates the dot code, then creates a .svg file by running
a dot command. The result is inserted below.
</p>
<pre class="code-ocaml" id="letdot_fileexampledotlet"><a class="paragraph-url" href="#letdot_fileexampledotlet"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div><span class="hl kwa">let</span> dot_file <span class="hl opt">=</span> <span class="hl str">&quot;example.dot&quot;</span><span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> svg_file <span class="hl opt">= (</span><span class="hl kwc">Filename</span><span class="hl opt">.</span>chop_extension dot_file<span class="hl opt">)</span>^<span class="hl str">&quot;.svg&quot;</span><span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> dot_code <span class="hl opt">=</span> <span class="hl kwc">Rdf_dot</span><span class="hl opt">.</span>dot_of_graph g<span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> <span class="hl opt">() =</span>
  <span class="hl kwa">let</span> oc <span class="hl opt">=</span> open_out dot_file <span class="hl kwa">in</span>
  output_string oc dot_code<span class="hl opt">;</span>
  close_out oc<span class="hl opt">;;</span></div><div><span class="hl kwa">let</span> com <span class="hl opt">=</span> <span class="hl kwc">Printf</span><span class="hl opt">.</span>sprintf <span class="hl str">&quot;dot -Grankdir=TB -Tsvg -o %s %s&quot;</span>
  <span class="hl opt">(</span><span class="hl kwc">Filename</span><span class="hl opt">.</span>quote svg_file<span class="hl opt">) (</span><span class="hl kwc">Filename</span><span class="hl opt">.</span>quote dot_file<span class="hl opt">);;</span></div><div><span class="hl kwa">if</span> <span class="hl kwc">Sys</span><span class="hl opt">.</span>command com <span class="hl opt">&lt;&gt;</span> <span class="hl num">0</span> <span class="hl kwa">then</span> failwith <span class="hl str">&quot;Exec error&quot;</span><span class="hl opt">;;</span></div></pre>
<img src="example.svg"/>
</div>

<div class="section"><div class="section-title" id="namespaces">Namespaces</div>
<p id="Eachgraphhasassociatedna"><a class="paragraph-url" href="#Eachgraphhasassociatedna"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Each graph has associated namespaces, i.e. pairs or (prefix, IRI), used
to shorten the (XML, Turtle, ...) outputs.
</p>
<p id="Whenloadingagraphfromafi"><a class="paragraph-url" href="#Whenloadingagraphfromafi"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
When loading a graph from a file, the namespaces used in the file
are automatically added to the graph, so that outputting the graph
will make use of the same namespaces.
</p>
<p id="Namespacesofagraphcanals"><a class="paragraph-url" href="#Namespacesofagraphcanals"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>
Namespaces of a graph can also be set programmatically, using the
functions provided in each graph:
</p>
<pre class="code-ocaml" id="ListmapfunirinameRdf_iri"><a class="paragraph-url" href="#ListmapfunirinameRdf_iri"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a><div># <span class="hl kwc">List</span><span class="hl opt">.</span>map
  <span class="hl opt">(</span><span class="hl kwa">fun</span> <span class="hl opt">(</span>iri<span class="hl opt">,</span> name<span class="hl opt">) -&gt; (</span><span class="hl kwc">Rdf_iri</span><span class="hl opt">.</span><span class="hl kwb">string</span> iri<span class="hl opt">,</span> name<span class="hl opt">))</span>
  <span class="hl opt">(</span>g<span class="hl opt">.</span><span class="hl kwc">Rdf_graph</span><span class="hl opt">.</span>namespaces<span class="hl opt">());;</span></div><div class="ocaml-toplevel">- : (string * string) list =
[(&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;, &quot;rdf&quot;);
 (&quot;http://example.org/stuff/1.0/&quot;, &quot;ex&quot;);
 (&quot;http://purl.org/dc/elements/1.1/&quot;, &quot;dc&quot;)]</div></pre>
<p id="SeeRdf_graphgraphforothe"><a class="paragraph-url" href="#SeeRdf_graphgraphforothe"><img alt="anchor" src="http://zoggy.github.io/ocaml-rdf/paragraph-url.png"/></a>See 
<a href="http://zoggy.github.io/ocaml-rdf/refdoc/Rdf_graph.html#TYPEgraph">Rdf_graph.graph</a>
 for other functions.</p>
</div>




</div>

<footer id="bottombar">
</footer>
<script src="http://zoggy.github.io/ocaml-rdf/jquery.js" type="text/javascript">_</script>
<script src="http://zoggy.github.io/ocaml-rdf/bootstrap-collapse.js" type="text/javascript">_</script>

</body>
</html>